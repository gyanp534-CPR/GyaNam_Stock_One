<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Gyanam ‚Äî Auth Test</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; padding:18px; background:#0f1724; color:#e6eef8; }
    input { padding:8px; margin:6px 0; width:280px; display:block; }
    button { padding:8px 12px; margin:6px 6px 6px 0; cursor:pointer; }
    .dashboard-box { padding:10px; margin:8px 0; background:#0b1220; border:1px solid #233044; border-radius:6px; }
    h1,h2 { margin:8px 0; color:#bfe3ff; }
    #authStatus { margin-top:6px; color:#ffd; }
  </style>
</head>
<body>

<h1>üß† Gyanam ‚Äî Auth Test</h1>

<!-- üîê AUTH -->
<div id="authArea" class="dashboard-box">
  <h2>üîê Authentication</h2>

  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">

  <button id="btnSignup">Sign Up (Supabase)</button>
  <button id="btnLogin">Login (Admin / Supabase)</button>
  <button onclick="login()">Login (Admin / Supabase)</button>


  <div id="authStatus">Status: waiting‚Ä¶</div>
</div>

<!-- üöÄ DASHBOARD -->
<div id="dashboard" style="display:none;">
  <button id="btnLogout">Logout</button>
  <h2>üéâ Dashboard unlocked</h2>

  <div class="dashboard-box">You are logged in successfully.</div>
</div>

<!-- ‚úÖ Supabase JS (ONLY ONCE) -->
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>

<script>
/* =========================
   CONFIG
========================= */
const SUPABASE_URL = "https://xfavhimibtbkshzxwyss.supabase.co";
const SUPABASE_ANON_KEY = "PASTE_YOUR_ANON_KEY_HERE"; // optional for now

const ADMIN_EMAIL = "admin@gyanam.ai";
const ADMIN_PASSWORD = "admin123";

/* =========================
   INIT
========================= */
const supabase = supabaseJs.createClient(
  SUPABASE_URL,
  SUPABASE_ANON_KEY
);

function info(msg){
  document.getElementById("authStatus").innerText = "Status: " + msg;
}

function showDashboard(show){
  document.getElementById("dashboard").style.display = show ? "block" : "none";
  document.getElementById("authArea").style.display = show ? "none" : "block";
}

/* =========================
   LOGIN
========================= */
async function loginHandler(){
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value;

  // Admin login (dev)
  if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD){
    info("Admin login successful ‚úÖ");
    showDashboard(true);
    return;
  }

  // Supabase login
  if (!SUPABASE_ANON_KEY || SUPABASE_ANON_KEY.includes("PASTE")){
    info("Supabase anon key missing. Admin only.");
    return;
  }

  info("Trying Supabase login‚Ä¶");
  const { error } = await supabase.auth.signInWithPassword({ email, password });
  if (error){
    info("Login failed: " + error.message);
  } else {
    info("Supabase login successful ‚úÖ");
    showDashboard(true);
  }
}

/* =========================
   SIGNUP
========================= */
async function signupHandler(){
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value;

  if (!email || !password){
    info("Email & password required");
    return;
  }

  const { error } = await supabase.auth.signUp({ email, password });
  if (error){
    info("Signup failed: " + error.message);
  } else {
    info("Signup successful ‚Äî now login");
  }
}

/* =========================
   LOGOUT
========================= */
async function logoutHandler(){
  await supabase.auth.signOut();
  info("Logged out");
  showDashboard(false);
}

/* =========================
   EVENTS
========================= */
document.getElementById("btnLogin").addEventListener("click", loginHandler);
document.getElementById("btnSignup").addEventListener("click", signupHandler);
document.getElementById("btnLogout").addEventListener("click", logoutHandler);

info("Ready. Use admin@gyanam.ai / admin123");
</script>

</body>
</html>

